<div class="container-fluid">
  <div class="content-wrapper">	
		<div class="item-container">	
			<div class="container">	
			<hr>
				<div class="col-md-12">
					<div class="product col-md-3 service-image-left">          
						<center>
							<!-- <img id="item-display" src="http://www.corsair.com/Media/catalog/product/g/s/gs600_psu_sideview_blue_2.png" alt=""></img> -->
							<% if @product.default_image %>
	             	<%= image_tag @product.default_image.path, :style => "max-width:100%;z-index:999999;" %>
	            <% else %>
	              <%= image_tag "http://placehold.it/400x400" %>
	            <% end %>
						</center>
					</div>
					
					<div class="container service1-items col-sm-2 col-md-2 pull-left">
						<center>
							<a id="item-1" class="service1-item">
								<%= image_tag "http://placehold.it/110x71" %>
							</a>
							<a id="item-2" class="service1-item">
								<%= image_tag "http://placehold.it/110x71" %>
							</a>
							<a id="item-3" class="service1-item">
								<%= image_tag "http://placehold.it/110x71" %>
							</a>
						</center>
					</div>

					<div class="col-md-7">
						<div class="product-title"><%= @product.name %></div>
						<div class="product-desc"><%= @product.short_description %></div>
						<!-- <div class="product-rating"><i class="fa fa-star gold"></i> <i class="fa fa-star gold"></i> <i class="fa fa-star gold"></i> <i class="fa fa-star gold"></i> <i class="fa fa-star-o"></i> </div> -->
					<hr>
						<div class="product-title">
							<h3>Color and Size Selection</h3>
							<div class="row">
    						<div class="col-lg-12">
   
   			         	<div class="col-lg-3 col-md-4 col-xs-6">
        				   	<a class="thumbnail" href="#" data-image-id="" data-toggle="modal" 
        				   	data-title="This is my title" data-caption="Some lovely red flowers" 
        				   	data-image="http://onelive.us/wp-content/uploads/2014/08/flower-delivery-online.jpg" 
        				   	data-target="#image-gallery">
                			<div style="width:20px; height:20px; background-color:black;"></div>
            				</a>
        					</div>
            			<div class="col-lg-3 col-md-4 col-xs-6 thumb">
            				<a class="thumbnail" href="#" data-image-id="" data-toggle="modal" data-title="The car i dream about" data-caption="If you sponsor me, I can drive this car" data-image="http://www.picturesnew.com/media/images/car-image.jpg" data-target="#image-gallery">
                			<div style="width:20px; height:20px; background-color:red;"></div>
            				</a>
        					</div>
            			<div class="col-lg-3 col-md-4 col-xs-6 thumb">
            				<a class="thumbnail" href="#" data-image-id="" data-toggle="modal" data-title="Im so nice" data-caption="And if there is money left, my girlfriend will receive this car" data-image="http://upload.wikimedia.org/wikipedia/commons/7/78/1997_Fiat_Panda.JPG" data-target="#image-gallery">
                			<div style="width:20px; height:20px; background-color:green;"></div>
            				</a>
        					</div>
								</div>

								<div class="modal fade" id="image-gallery" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    							<div class="modal-dialog">
        						<div class="modal-content">
            					<div class="modal-header">
                				<button type="button" class="close" data-dismiss="modal">
                					<span aria-hidden="true">Ã—</span>
                					<span class="sr-only">Close</span>
                				</button>
                				<h4 class="modal-title" id="image-gallery-title"></h4>
            					</div>
            					<div class="modal-body">
                				<img id="image-gallery-image" class="img-responsive" src="">
            					</div>
            					<div class="modal-footer">
                				<div class="col-md-2">
                    			<button type="button" class="btn btn-primary" id="show-previous-image">
                    				Previous
                    			</button>
                				</div>

                				<div class="col-md-8 text-justify" id="image-gallery-caption">
                    			This text will be overwritten by jQuery
                				</div>

                				<div class="col-md-2">
                    			<button type="button" id="show-next-image" class="btn btn-default">Next</button>
                				</div>
            					</div>
        						</div>
    							</div>
								</div>
						</div>
					<hr>
						<div class="product-price"><%= number_to_currency @product.price %></div>
						<div class="product-stock">
							<% if @product.stock_control? %>
								In Stock
							<% else %>
								No Stock
							<% end %>
						</div>
					<hr>

						<div class="btn-group cart">
							<%= link_to "Add to Cart", product_path(@product.permalink), :method => :post, class: "ui button green" %>
						</div>
						<div class="btn-group wishlist">
							<%= link_to "Back to list", root_path, class: "ui button red", :style => 'float:right' %>
						</div>
					</div>
				</div> 
			</div>
			<div class="container-fluid">		
				<div class="col-md-12 product-info">
					<ul id="myTab" class="nav nav-tabs nav_tabs">		
						<li class="active"><a href="#service-one" data-toggle="tab">DESCRIPTION</a></li>
						<li><a href="#service-three" data-toggle="tab">REVIEWS</a></li>
					</ul>
					<div id="myTabContent" class="tab-content">
						<div class="tab-pane fade in active" id="service-one">
							<section class="container product-info">
								<h2>Details Below</h2><hr>
								<%= @product.description %>
							</section>
						</div>
						
						<div class="tab-pane fade" id="service-three">
							<section class="container">
								<h2>Under Construction</h2>
							</section>
						</div>
					</div>
				<hr>
				</div>
			</div>
		</div>
	</div>

	<br><br><hr>

	<div class="row">
    <%= render 'products' %>
  </div>
</div>

<script>
	$(document).ready(function(){

    loadGallery(true, 'a.thumbnail');

    //This function disables buttons when needed
    function disableButtons(counter_max, counter_current){
        $('#show-previous-image, #show-next-image').show();
        if(counter_max == counter_current){
            $('#show-next-image').hide();
        } else if (counter_current == 1){
            $('#show-previous-image').hide();
        }
    }

    /**
     *
     * @param setIDs        Sets IDs when DOM is loaded. If using a PHP counter, set to false.
     * @param setClickAttr  Sets the attribute for the click handler.
     */

    function loadGallery(setIDs, setClickAttr){
        var current_image,
            selector,
            counter = 0;

        $('#show-next-image, #show-previous-image').click(function(){
            if($(this).attr('id') == 'show-previous-image'){
                current_image--;
            } else {
                current_image++;
            }

            selector = $('[data-image-id="' + current_image + '"]');
            updateGallery(selector);
        });

        function updateGallery(selector) {
            var $sel = selector;
            current_image = $sel.data('image-id');
            $('#image-gallery-caption').text($sel.data('caption'));
            $('#image-gallery-title').text($sel.data('title'));
            $('#image-gallery-image').attr('src', $sel.data('image'));
            disableButtons(counter, $sel.data('image-id'));
        }

        if(setIDs == true){
            $('[data-image-id]').each(function(){
                counter++;
                $(this).attr('data-image-id',counter);
            });
        }
        $(setClickAttr).on('click',function(){
            updateGallery($(this));
        });
    }
});
</script>